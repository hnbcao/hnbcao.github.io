<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="Kubernetes优化" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://hnbcao.vip/tags/kubernetes%E4%BC%98%E5%8C%96/" />

<title>Kubernetes优化 | HNBCAO</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.46181bc93375ba932026e753b37c40e6ff8bb16a9ef770c78bcc663e4577b1ba.css" integrity="sha256-RhgbyTN1upMgJudTs3xA5v&#43;LsWqe93DHi8xmPkV3sbo=" crossorigin="anonymous">
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.4ea6536c9966b69a06b412bb583f9945a942f9cb817c4f23f7d2420373829da8.js" integrity="sha256-TqZTbJlmtpoGtBK7WD&#43;ZRalC&#43;cuBfE8j99JCA3OCnag=" crossorigin="anonymous"></script>
<link rel="alternate" type="application/rss+xml" href="https://hnbcao.vip/tags/kubernetes%E4%BC%98%E5%8C%96/index.xml" title="HNBCAO" />
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>HNBCAO</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Golang学习笔记</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-1c612c7b4b8439389939ab8807294c71" class="toggle"  />
    <label for="section-1c612c7b4b8439389939ab8807294c71" class="flex justify-between">
      <a role="button" class="">基础知识</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/golang/basic/for-and-range/" class="">for 和 range</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/golang/basic/select/" class="">Select 关键字</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-cb87749ee672152a5caec4a87698c2a8" class="toggle"  />
    <label for="section-cb87749ee672152a5caec4a87698c2a8" class="flex justify-between">
      <a role="button" class="">运行时</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/golang/runtime/context/" class="">上下文 Context</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/golang/runtime/mutex/" class="">同步原语与锁</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-08b535e490eca27ad24a819af5f72970" class="toggle"  />
    <label for="section-08b535e490eca27ad24a819af5f72970" class="flex justify-between">
      <a role="button" class="">进阶知识</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/golang/advanced/escape_analysis/" class="">逃逸分析</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Java学习笔记</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-78c6ac321443b1383507da57e50915e5" class="toggle"  />
    <label for="section-78c6ac321443b1383507da57e50915e5" class="flex justify-between">
      <a role="button" class="">笔记</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/java/note/collections/" class="">Java容器学习笔记</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/java/note/spring-kafka-properties/" class="">Spring Kafka参数配置详情</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>容器化</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-de0837145b8d41bd524e86425c79ce30" class="toggle"  />
    <label for="section-de0837145b8d41bd524e86425c79ce30" class="flex justify-between">
      <a role="button" class="">Docker</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/container/docker/docker-compose-installation/" class="">Docker Compose安装使用</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c9c13742e83e082551e7692418cffc0e" class="toggle"  />
    <label for="section-c9c13742e83e082551e7692418cffc0e" class="flex justify-between">
      <a role="button" class="">Kubernetes</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/container/kubernetes/1-kubernetes-cluster-installation/" class="">Kubernetes集群安装</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/container/kubernetes/2-kubernetes-cert-manager/" class="">Kubernetes集群安装Cert Manager</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/container/kubernetes/3-kubernetes-traefik-ingress/" class="">Kubernetes集群安装Traefik Ingress</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/container/kubernetes/4-create-kubernetes-user/" class="">Kubernetes集群创建用户</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/container/kubernetes/5-kubernetes-create-image-pull-secret/" class="">Kubernetes集群创建Image Pull Secret</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/container/kubernetes/6-kubernetes-seo/" class="">kubernetes集群运行问题记录</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/container/kubernetes/7-kubernetes-with-aliyungpu/" class="">Kubernetes集群GPU共享解决方案</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>运维管理</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-2fdb1b25835f7654408a6759bed146e9" class="toggle"  />
    <label for="section-2fdb1b25835f7654408a6759bed146e9" class="flex justify-between">
      <a role="button" class="">操作系统</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/seo/system/create-offline-yum-repo/" class="">CentOS离线镜像仓库创建</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0bad6e65e759e297a009b1e26f924cc0" class="toggle"  />
    <label for="section-0bad6e65e759e297a009b1e26f924cc0" class="flex justify-between">
      <a role="button" class="">中间件</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/seo/middleware/canal-installation/" class="">Canal安装部署</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/seo/middleware/ceph-installation/" class="">Ceph集群安装</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/seo/middleware/ftp-installation/" class="">FTP服务器搭建</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/seo/middleware/fluent-bit-configuration/" class="">Fluent-bit日志插件配置说明</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>软件工程</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://hnbcao.vip/docs/design/design-pattern/" class="">设计模式简介</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>











  
<ul>
  
  <li>
    <a href="/posts/" >
        Blog
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Kubernetes优化</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  <nav>
  <ul>
  
    
    <li class="book-section-flat">
      <strong>Categories</strong>
      <ul>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%BF%90%E7%BB%B4/">运维</a>
          <span>8</span>
        </li>
      
      </ul>
    </li>
    
  
    
    <li class="book-section-flat">
      <strong>Tags</strong>
      <ul>
      
        <li class="flex justify-between">
          <a href="/tags/kubernetes/">Kubernetes</a>
          <span>7</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/%E5%AE%B9%E5%99%A8%E5%8C%96/">容器化</a>
          <span>7</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/%E8%BF%90%E7%BB%B4/">运维</a>
          <span>8</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/docker/">Docker</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/docker-compose/">docker-compose</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/bugs/">Bugs</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/kubernetes%E4%BC%98%E5%8C%96/">Kubernetes优化</a>
          <span>4</span>
        </li>
      
      </ul>
    </li>
    
  
  </ul>
</nav>


  </aside>
  
 
      </header>

      
      
  
  <article class="markdown book-post">
    <h2>
      <a href="/docs/container/kubernetes/2-kubernetes-cert-manager/">Kubernetes集群安装Cert Manager</a>
    </h2>
    
  <h5>December 31, 2019</h5>



  
  <div>
    
      <a href="/categories/%E8%BF%90%E7%BB%B4/">运维</a>
  </div>
  

  
  <div>
    
      <a href="/tags/kubernetes/">Kubernetes</a>, 
      <a href="/tags/%E8%BF%90%E7%BB%B4/">运维</a>, 
      <a href="/tags/%E5%AE%B9%E5%99%A8%E5%8C%96/">容器化</a>, 
      <a href="/tags/kubernetes%E4%BC%98%E5%8C%96/">Kubernetes优化</a>
  </div>
  




    <p>安装Cert Manager #  一、Installing the Chart #  https://cert-manager.io/docs/installation/kubernetes/
二、创建ClusterIssuer(集群内所有命名空间公用方案) #  apiVersion: cert-manager.io/v1alpha2 kind: ClusterIssuer metadata: name: cluster-letsencrypt-prod spec: acme: email: hnbcao@qq.com privateKeySecretRef: name: cluster-letsencrypt-prod server: https://acme-v02.api.letsencrypt.org/directory solvers: - http01: ingress: class: traefik 三、创建Issuer(集群内单个命名空间独享方案) #  apiVersion: cert-manager.io/v1alpha2 kind: Issuer metadata: name: letsencrypt-prod spec: acme: email: hnbcao@qq.com privateKeySecretRef: name: letsencrypt-prod server: https://acme-v02.api.letsencrypt.org/directory solvers: - http01: ingress: class: traefik 四、Ingress应用ClusterIssuer #  kind: Ingress apiVersion: extensions/v1beta1 metadata: name: harbor-ingress namespace: ns-harbor labels: app: harbor chart: harbor heritage: Helm release: harbor annotations: cert-manager.
        <a href="/docs/container/kubernetes/2-kubernetes-cert-manager/">...</a>
      
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/docs/container/kubernetes/3-kubernetes-traefik-ingress/">Kubernetes集群安装Traefik Ingress</a>
    </h2>
    
  <h5>December 31, 2019</h5>



  
  <div>
    
      <a href="/categories/%E8%BF%90%E7%BB%B4/">运维</a>
  </div>
  

  
  <div>
    
      <a href="/tags/kubernetes/">Kubernetes</a>, 
      <a href="/tags/%E8%BF%90%E7%BB%B4/">运维</a>, 
      <a href="/tags/%E5%AE%B9%E5%99%A8%E5%8C%96/">容器化</a>, 
      <a href="/tags/kubernetes%E4%BC%98%E5%8C%96/">Kubernetes优化</a>
  </div>
  




    <p>部署TraefikIngress #  使用OpenSSL创建TLS证书（已有证书则跳过该选项） #   设置证书信息  cd ~ &amp;&amp; mkdir tls echo &#34;&#34;&#34; [req] distinguished_name = req_distinguished_name prompt = yes [ req_distinguished_name ] countryName = Country Name (2 letter code) countryName_value = CN stateOrProvinceName = State or Province Name (full name) stateOrProvinceName_value = Chongqing localityName = Locality Name (eg, city) localityName_value = Yubei organizationName = Organization Name (eg, company) organizationName_value = HNBCAO organizationalUnitName = Organizational Unit Name (eg, section) organizationalUnitName_value = R &amp; D Department commonName = Common Name (eg, your name or your server\&#39;s hostname) commonName_value = *.
        <a href="/docs/container/kubernetes/3-kubernetes-traefik-ingress/">...</a>
      
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/docs/container/kubernetes/4-create-kubernetes-user/">Kubernetes集群创建用户</a>
    </h2>
    
  <h5>December 31, 2019</h5>



  
  <div>
    
      <a href="/categories/%E8%BF%90%E7%BB%B4/">运维</a>
  </div>
  

  
  <div>
    
      <a href="/tags/kubernetes/">Kubernetes</a>, 
      <a href="/tags/%E8%BF%90%E7%BB%B4/">运维</a>, 
      <a href="/tags/%E5%AE%B9%E5%99%A8%E5%8C%96/">容器化</a>, 
      <a href="/tags/kubernetes%E4%BC%98%E5%8C%96/">Kubernetes优化</a>
  </div>
  




    <p>创建集群用户 #  1、创建用户
apiVersion: v1 kind: ServiceAccount metadata: name: admin-user namespace: kube-system --- apiVersion: rbac.authorization.k8s.io/v1beta1 kind: ClusterRoleBinding metadata: name: admin-user annotations: rbac.authorization.kubernetes.io/autoupdate: &#34;true&#34; roleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: cluster-admin subjects: - kind: ServiceAccount name: admin-user namespace: kube-system 2、获取管理员用户的Token，通过执行如下命令获取系统Token信息
kubectl describe secret admin-user --namespace=kube-system 3、导入kubeconfig文件
DASH_TOCKEN=$(kubectl get secret -n kube-system admin-user-token-4j272 -o jsonpath={.data.token}|base64 -d) kubectl config set-cluster kubernetes --server=https://172.16.0.9:8443 --kubeconfig=/root/kube-admin.conf kubectl config set-credentials admin-user --token=$DASH_TOCKEN --kubeconfig=/root/kube-admin.conf kubectl config set-context admin-user@kubernetes --cluster=kubernetes --user=admin-user --kubeconfig=/root/kube-admin.
        <a href="/docs/container/kubernetes/4-create-kubernetes-user/">...</a>
      
    </p>
  </article>
  
  <article class="markdown book-post">
    <h2>
      <a href="/docs/container/kubernetes/5-kubernetes-create-image-pull-secret/">Kubernetes集群创建Image Pull Secret</a>
    </h2>
    
  <h5>December 31, 2019</h5>



  
  <div>
    
      <a href="/categories/%E8%BF%90%E7%BB%B4/">运维</a>
  </div>
  

  
  <div>
    
      <a href="/tags/kubernetes/">Kubernetes</a>, 
      <a href="/tags/%E8%BF%90%E7%BB%B4/">运维</a>, 
      <a href="/tags/%E5%AE%B9%E5%99%A8%E5%8C%96/">容器化</a>, 
      <a href="/tags/kubernetes%E4%BC%98%E5%8C%96/">Kubernetes优化</a>
  </div>
  




    <p>创建ImagePullSecret #  一、登录镜像仓库，成功之后会生成如下/root/.docker/config.json文件 #  { &#34;auths&#34;: { &#34;harbor.hnbcao.tech&#34;: { &#34;auth&#34;: &#34;YWRtaW4******lRlY2g=&#34; } }, &#34;HttpHeaders&#34;: { &#34;User-Agent&#34;: &#34;Docker-Client/***&#34; } } 二、执行如下命令创建ImagePullSecret #  kubectl create secret generic harbor-admin-secret --from-file=.dockerconfigjson=/root/.docker/config.json --type=kubernetes.io/dockerconfigjson --namespace hnbcao-mixing-ore 说明：
 harbor-admin-secret： ImagePullSecret名字 type： 指定secret类型为kubernetes.io/dockerconfigjson namespace：secret命名空间  四、为项目添加ImagePullSecret #   Deployment  在配置项的spec.template.spec.imagePullSecrets下添加secret：harbor-admin-secret。例如，Deployment的配置如下：
kind: Deployment apiVersion: apps/v1 metadata: name: app-test spec: replicas: 1 selector: matchLabels: app.kubernetes.io/instance: app-test app.kubernetes.io/name: hnbcao template: metadata: labels: app.kubernetes.io/instance: app-test app.kubernetes.io/name: hnbcao spec: containers: - name: hnbcao image: nginx imagePullSecrets: - name: harbor-admin-secret 结束 #  附上官网教程：https://kubernetes.
        <a href="/docs/container/kubernetes/5-kubernetes-create-image-pull-secret/">...</a>
      
    </p>
  </article>
  

  
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  <nav>
  <ul>
  
    
    <li class="book-section-flat">
      <strong>Categories</strong>
      <ul>
      
        <li class="flex justify-between">
          <a href="/categories/%E8%BF%90%E7%BB%B4/">运维</a>
          <span>8</span>
        </li>
      
      </ul>
    </li>
    
  
    
    <li class="book-section-flat">
      <strong>Tags</strong>
      <ul>
      
        <li class="flex justify-between">
          <a href="/tags/kubernetes/">Kubernetes</a>
          <span>7</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/%E5%AE%B9%E5%99%A8%E5%8C%96/">容器化</a>
          <span>7</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/%E8%BF%90%E7%BB%B4/">运维</a>
          <span>8</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/docker/">Docker</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/docker-compose/">docker-compose</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/bugs/">Bugs</a>
          <span>1</span>
        </li>
      
        <li class="flex justify-between">
          <a href="/tags/kubernetes%E4%BC%98%E5%8C%96/">Kubernetes优化</a>
          <span>4</span>
        </li>
      
      </ul>
    </li>
    
  
  </ul>
</nav>

 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












